<?xml version="1.0" encoding="UTF-8"?>
<Schema name="datachile">

  <!-- BEGIN: Shared Dimensions -->
  <Dimension name="Date" type="TimeDimension">
    <Hierarchy hasAll="true" primaryKey="id">
      <Table schema="public" name="dim_date" />
      <Level column="the_year" levelType="TimeYears" name="Year" type="Numeric" uniqueMembers="true"/>
      <Level column="month_of_year" levelType="TimeMonths" name="Month" type="Numeric" uniqueMembers="false" />
      <Level column="day_of_month" levelType="TimeDays" name="Day" type="Numeric" uniqueMembers="false" />
    </Hierarchy>
  </Dimension>

  <Dimension name="Geography">
    <Hierarchy hasAll="true" primaryKey="id">
      <Table name="dim_comunas" schema="public" />
      <Level name="Region" column="region_id" nameColumn="region_name" uniqueMembers="true" />
      <Level name="Comuna" column="comuna_datachile_id" nameColumn="comuna_name" uniqueMembers="false" />
    </Hierarchy>
  </Dimension>

  <Dimension name="Country">
    <Hierarchy hasAll="true" primaryKey="country_code">
      <Table name="dim_countries_new" schema="public" />
      <Level name="Region" column="region_code" nameColumn="region" uniqueMembers="true" />
      <Level name="Subregion" column="sub_region_code" nameColumn="sub_region" uniqueMembers="true" />
      <Level name="Country" column="country_code" nameColumn="country_name" uniqueMembers="true">
          <Annotations>
              <Annotation name="es_caption">Country ES</Annotation>
          </Annotations>
          <Property name="Country ES" column="es_country_name" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="HS">
    <Hierarchy hasAll="true" primaryKey="level3">
      <Table name="hs_levels" schema="economy" />
      <Level name="HS0" column="level0" nameColumn="level0_name" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">HS0 ES</Annotation>
        </Annotations>
        <Property name="HS0 ES" column="es_level0_description" />
      </Level>
      <Level name="HS2" column="level1" nameColumn="level1_name" uniqueMembers="false" />
      <Level name="HS4" column="level2" nameColumn="level2_name" uniqueMembers="false" />
      <Level name="HS6" column="level3" nameColumn="level3_name" uniqueMembers="false" />
    </Hierarchy>
  </Dimension>

  <Dimension name="ISICrev4">
    <Hierarchy hasAll="true" primaryKey="level4">
      <Table name="dim_isic" schema="public" />
      <Level name="Level 1" column="level1" nameColumn="level1_description" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">Level 1 ES</Annotation>
        </Annotations>
        <Property name="Level 1 ES" column="es_level1_description" />
      </Level>
      <Level name="Level 2" column="level2" nameColumn="level2_description" uniqueMembers="false">
        <Annotations>
          <Annotation name="es_caption">Level 2 ES</Annotation>
        </Annotations>
        <Property name="Level 2 ES" column="es_level2_description" />
      </Level>
      <Level name="Level 3" column="level3" nameColumn="level3_description" uniqueMembers="false">
        <Annotations>
          <Annotation name="es_caption">Level 3 ES</Annotation>
        </Annotations>
        <Property name="Level 3 ES" column="es_level3_description" />
      </Level>
      <Level name="Level 4" column="level4" nameColumn="level4_description" uniqueMembers="false">
        <Annotations>
          <Annotation name="es_caption">Level 4 ES</Annotation>
        </Annotations>
        <Property name="Level 4 ES" column="es_level4_description" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="Sex">
    <Hierarchy hasAll="true" primaryKey="sex_id">
        <InlineTable alias="dim_sex">
          <ColumnDefs>
            <ColumnDef name="sex_id" type="Numeric"/>
            <ColumnDef name="description" type="String"/>
            <ColumnDef name="es_description" type="String"/>
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="sex_id">0</Value>
              <Value column="description">N/A</Value>
              <Value column="es_description">N/A</Value>
            </Row>
            <Row>
              <Value column="sex_id">2</Value>
              <Value column="description">Male</Value>
              <Value column="es_description">Masculino</Value>
            </Row>
            <Row>
              <Value column="sex_id">1</Value>
              <Value column="description">Female</Value>
              <Value column="es_description">Femenino</Value>
            </Row>
          </Rows>
        </InlineTable>
        <Level name="Sex" column="sex_id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="ISCED">
    <Hierarchy hasAll="true">
      <InlineTable alias="isced">
        <ColumnDefs>
          <ColumnDef name="id" type="Numeric" />
          <ColumnDef name="description" type="String" />
          <ColumnDef name="es_description" type="String" />
        </ColumnDefs>
        <Rows>
          <Row>
            <Value column="id">1</Value>
            <Value column="description">Doctorado</Value>
            <Value column="es_description">Doctorado</Value>
          </Row>
          <Row>
            <Value column="id">2</Value>
            <Value column="description">Educación Preescolar</Value>
            <Value column="es_description">Educación Preescolar</Value>
          </Row>
          <Row>
            <Value column="id">3</Value>
            <Value column="description">Educación Primaria (nivel 1)</Value>
            <Value column="es_description">Educación Primaria (nivel 1)</Value>
          </Row>
          <Row>
            <Value column="id">4</Value>
            <Value column="description">Educación Primaria (nivel 2)</Value>
            <Value column="es_description">Educación Primaria (nivel 2)</Value>
          </Row>
          <Row>
            <Value column="id">5</Value>
            <Value column="description">Educación Secundaria</Value>
            <Value column="es_description">Educación Secundaria</Value>
          </Row>
          <Row>
            <Value column="id">6</Value>
            <Value column="description">Educación Técnica (Educación Superior no Universitaria)</Value>
            <Value column="es_description">Educación Técnica (Educación Superior no Universitaria)</Value>
          </Row>
          <Row>
            <Value column="id">7</Value>
            <Value column="description">Educación Universitaria</Value>
            <Value column="es_description">Educación Universitaria</Value>
          </Row>
          <Row>
            <Value column="id">8</Value>
            <Value column="description">Nivel ignorado</Value>
            <Value column="es_description">Nivel ignorado</Value>
          </Row>
          <Row>
            <Value column="id">9</Value>
            <Value column="description">Nunca estudió</Value>
            <Value column="es_description">Nunca estudió</Value>
          </Row>
          <Row>
            <Value column="id">10</Value>
            <Value column="description">Postítulo y Maestría</Value>
            <Value column="es_description">Postítulo y Maestría</Value>
          </Row>
          <Row>
            <Value column="id">0</Value>
            <Value column="description">No sabe/No responde</Value>
            <Value column="es_description">No sabe/No responde</Value>
          </Row>
        </Rows>
      </InlineTable>
      <Level name="ISCED" column="id" nameColumn="description" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">Description ES</Annotation>
        </Annotations>
        <Property name="Description ES" column="es_description" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="ICSE">
    <Hierarchy hasAll="true">
      <InlineTable alias="icse">
        <ColumnDefs>
          <ColumnDef name="id" type="Numeric" />
          <ColumnDef name="description" type="String" />
          <ColumnDef name="es_description" type="String" />
        </ColumnDefs>
        <Rows>
          <Row>
            <Value column="id">1</Value>
            <Value column="description">Asalariado Sector Privado</Value>
            <Value column="es_description">Asalariado Sector Privado</Value>
          </Row>
          <Row>
            <Value column="id">2</Value>
            <Value column="description">Asalariado Sector Público</Value>
            <Value column="es_description">Asalariado Sector Público</Value>
          </Row>
          <Row>
            <Value column="id">3</Value>
            <Value column="description">Cuenta Propia</Value>
            <Value column="es_description">Cuenta Propia</Value>
          </Row>
          <Row>
            <Value column="id">4</Value>
            <Value column="description">Empleador</Value>
            <Value column="es_description">Empleador</Value>
          </Row>
          <Row>
            <Value column="id">5</Value>
            <Value column="description">Personal de Servicio Doméstico Puertas Adentro</Value>
            <Value column="es_description">Personal de Servicio Doméstico Puertas Adentro</Value>
          </Row>
          <Row>
            <Value column="id">6</Value>
            <Value column="description">Personal de Servicio Doméstico Puertas Afuera</Value>
            <Value column="es_description">Personal de Servicio Doméstico Puertas Afuera</Value>
          </Row>
          <Row>
            <Value column="id">0</Value>
            <Value column="description">No sabe/No responde</Value>
            <Value column="es_description">No sabe/No responde</Value>
          </Row>
        </Rows>
      </InlineTable>
      <Level name="ICSE" column="id" nameColumn="description" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">Description ES</Annotation>
        </Annotations>
        <Property name="Description ES" column="es_description" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="ISCO">
    <Hierarchy hasAll="true">
      <InlineTable alias="isco">
        <ColumnDefs>
          <ColumnDef name="id" type="Numeric" />
          <ColumnDef name="description" type="String" />
          <ColumnDef name="es_description" type="String" />
        </ColumnDefs>
        <Rows>
          <Row>
            <Value column="id">1</Value>
            <Value column="description">Agricultores y trabajadores calificados agropecuarios y pesqueros</Value>
            <Value column="es_description">Agricultores y trabajadores calificados agropecuarios y pesqueros</Value>
          </Row>
          <Row>
            <Value column="id">2</Value>
            <Value column="description">Empleados de oficina</Value>
            <Value column="es_description">Empleados de oficina</Value>
          </Row>
          <Row>
            <Value column="id">3</Value>
            <Value column="description">Funcionarios públicos y personal directivo de la administración pública y empresas</Value>
            <Value column="es_description">Funcionarios públicos y personal directivo de la administración pública y empresas</Value>
          </Row>
          <Row>
            <Value column="id">4</Value>
            <Value column="description">Oficiales, operarios y artesanos de artes mecánicas y de otros oficios</Value>
            <Value column="es_description">Oficiales, operarios y artesanos de artes mecánicas y de otros oficios</Value>
          </Row>
          <Row>
            <Value column="id">5</Value>
            <Value column="description">Operadores de instalaciones y máquinas y montadores</Value>
            <Value column="es_description">Operadores de instalaciones y máquinas y montadores</Value>
          </Row>
          <Row>
            <Value column="id">6</Value>
            <Value column="description">Otros no identificados</Value>
            <Value column="es_description">Otros no identificados</Value>
          </Row>
          <Row>
            <Value column="id">7</Value>
            <Value column="description">Profesionales científicos e intelectuales</Value>
            <Value column="es_description">Profesionales científicos e intelectuales</Value>
          </Row>
          <Row>
            <Value column="id">8</Value>
            <Value column="description">Técnicos y profesionales de nivel medio</Value>
            <Value column="es_description">Técnicos y profesionales de nivel medio</Value>
          </Row>
          <Row>
            <Value column="id">9</Value>
            <Value column="description">Trabajadores de los servicios y vendedores de comercios y mercados</Value>
            <Value column="es_description">Trabajadores de los servicios y vendedores de comercios y mercados</Value>
          </Row>
          <Row>
            <Value column="id">10</Value>
            <Value column="description">Trabajadores no calificados</Value>
            <Value column="es_description">Trabajadores no calificados</Value>
          </Row>
          <Row>
            <Value column="id">0</Value>
            <Value column="description">No sabe/No responde</Value>
            <Value column="es_description">No sabe/No responde</Value>
          </Row>
        </Rows>
      </InlineTable>
      <Level name="ISCO" column="id" nameColumn="description" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">Description ES</Annotation>
        </Annotations>
        <Property name="Description ES" column="es_description" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="Binary Survey Response">
    <Hierarchy hasAll="true">
      <InlineTable alias="survey_response">
        <ColumnDefs>
          <ColumnDef name="id" type="Numeric" />
          <ColumnDef name="description" type="String" />
          <ColumnDef name="es_description" type="String" />
        </ColumnDefs>
        <Rows>
          <Row>
            <Value column="id">0</Value>
            <Value column="description">N/A</Value>
            <Value column="es_description">N/A</Value>
          </Row>
          <Row>
            <Value column="id">1</Value>
            <Value column="description">No</Value>
            <Value column="es_description">No</Value>
          </Row>
          <Row>
            <Value column="id">2</Value>
            <Value column="description">Yes</Value>
            <Value column="es_description">Sí</Value>
          </Row>
        </Rows>
      </InlineTable>
      <Level name="Survey Response" column="id" nameColumn="description" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">Description ES</Annotation>
        </Annotations>
        <Property name="Description ES" column="es_description" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="Age Range">
    <Hierarchy hasAll="true">


      <InlineTable alias="age_range">
	<ColumnDefs>
	  <ColumnDef name="id" type="Numeric" />
	  <ColumnDef name="description" type="String" />
	  <ColumnDef name="es_description" type="String" />
	</ColumnDefs>
	<Rows>
	  <Row>
	    <Value column="id">0</Value>
	    <Value column="description">nan</Value>
	    <Value column="es_description">nan</Value>
	  </Row>
	  <Row>
	    <Value column="id">1</Value>
	    <Value column="description">Menos de 15</Value>
	    <Value column="es_description">Menos de 15</Value>
	  </Row>
	  <Row>
	    <Value column="id">2</Value>
	    <Value column="description">15 a 19</Value>
	    <Value column="es_description">15 a 19</Value>
	  </Row>
	  <Row>
	    <Value column="id">3</Value>
	    <Value column="description">20 a 24</Value>
	    <Value column="es_description">20 a 24</Value>
	  </Row>
	  <Row>
	    <Value column="id">4</Value>
	    <Value column="description">25 a 29</Value>
	    <Value column="es_description">25 a 29</Value>
	  </Row>
	  <Row>
	    <Value column="id">5</Value>
	    <Value column="description">30 a 65</Value>
	    <Value column="es_description">30 a 65</Value>
	  </Row>
	  <Row>
	    <Value column="id">6</Value>
	    <Value column="description">65 a edad max</Value>
	    <Value column="es_description">65 a edad max</Value>
	  </Row>
	</Rows>
      </InlineTable>
      <Level name="Age Range" column="id" nameColumn="description" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">Description ES</Annotation>
        </Annotations>
        <Property name="Description ES" column="es_description" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="Zone">
    <Hierarchy hasAll="true">
      <InlineTable alias="zone">
        <ColumnDefs>
          <ColumnDef name="id" type="Numeric" />
          <ColumnDef name="description" type="String" />
          <ColumnDef name="es_description" type="String" />
        </ColumnDefs>
        <Rows>
          <Row>
            <Value column="id">0</Value>
            <Value column="description">NA</Value>
            <Value column="es_description">NA</Value>
          </Row>
          <Row>
            <Value column="id">1</Value>
            <Value column="description">Urban</Value>
            <Value column="es_description">Urbano</Value>
          </Row>
          <Row>
            <Value column="id">2</Value>
            <Value column="description">Rural</Value>
            <Value column="es_description">Rural</Value>
          </Row>
        </Rows>
      </InlineTable>
      <Level name="Zone" column="id" nameColumn="description" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">Description ES</Annotation>
        </Annotations>
        <Property name="Description ES" column="es_description" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="Administration">
    <Hierarchy hasAll="true">
      
      <InlineTable alias="administration">
        <ColumnDefs>
          <ColumnDef name="id" type="Numeric" />
          <ColumnDef name="description" type="String" />
          <ColumnDef name="es_description" type="String" />
        </ColumnDefs>
        <Rows>
          <Row>
            <Value column="id">0</Value>
            <Value column="description">nan</Value>
            <Value column="es_description">nan</Value>
          </Row>
        <Row>
            <Value column="id">1</Value>
            <Value column="description">Corporación Municipal</Value>
            <Value column="es_description">Corporación Municipal</Value>
          </Row>
        <Row>
            <Value column="id">2</Value>
            <Value column="description">Municipal DAEM</Value>
            <Value column="es_description">Municipal DAEM</Value>
          </Row>
        <Row>
            <Value column="id">3</Value>
            <Value column="description">Particular Subvencionado</Value>
            <Value column="es_description">Particular Subvencionado</Value>
          </Row>
        <Row>
            <Value column="id">4</Value>
            <Value column="description">Particular Pagado</Value>
            <Value column="es_description">Particular Pagado</Value>
          </Row>
        <Row>
            <Value column="id">5</Value>
            <Value column="description">Corporación de Administración Delegada</Value>
            <Value column="es_description">Corporación de Administración Delegada</Value>
          </Row>
        </Rows>
      </InlineTable>
      
      <Level name="Administration" column="id" nameColumn="description" uniqueMembers="true">
        <Annotations>
          <Annotation name="es_caption">Description ES</Annotation>
        </Annotations>
        <Property name="Description ES" column="es_description" />
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="Institution">
    <Hierarchy hasAll="true" primaryKey="institution_id">
      <Table name="dim_educational_institutions" schema="education" />
      <Level name="Institution" column="institution_id" nameColumn="institution" uniqueMembers="true" />
    </Hierarchy>
  </Dimension>

  <Dimension name="Teaching">
    <Hierarchy hasAll="true" primaryKey="teaching_id">
      <Table name="dim_teachings" schema="education" />
      <Level name="Teaching" column="teaching_id" nameColumn="teaching" uniqueMembers="true" />
    </Hierarchy>
  </Dimension>

  <!-- END: Shared Dimensions -->

  <Cube name="exports">
    <Table name="pg_exports_grouped" schema="economy" />

    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Destination Country" caption="Destination Country" source="Country" foreignKey="country_dest_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="exporter_comuna_id" />
    <DimensionUsage name="Export HS" source="HS" foreignKey="hs_level3" />

    <!-- Measure name="Q Traded" column="q_traded" aggregator="sum" / -->
    <Measure name="FOB US" column="fob_us" aggregator="sum" />
    <Measure name="rca_internal" column="region_rca" aggregator="min" visible="false" />

    <CalculatedMember name="RCA" dimension="Measures">
      <Formula>
        CASE
          WHEN [Geography].Level is [Geography].[Region] AND [Export HS].Level is [Export HS].[HS4] THEN [Measures].[rca_internal]
          ELSE Null
        END
      </Formula>
    </CalculatedMember>

    <CalculatedMember name="Geo Rank" dimension="Measures">
      <Formula>
        IIf(IsEmpty([Measures].[FOB US]),
            Null,
            Rank([Geography].CurrentMember,
                 Order([Geography].CurrentMember.Siblings,
                 Measures.[FOB US], BDESC)))
      </Formula>
    </CalculatedMember>

    <CalculatedMember name="Geo Rank Across Time" dimension="Measures">
      <Annotations>
        <Annotation name="description">Rank of this geography across all its siblings, by time</Annotation>
      </Annotations>
      <Formula>
        Iif(IsEmpty([Measures].[FOB US]),
            Null,
        Rank([Geography].CurrentMember,
          Order([Geography].CurrentMember.Siblings,
                Aggregate({[Date].CurrentMember}*{[Destination Country].[All Destination Countrys]}*{[Export HS].[All Export HSs]},
                          [Measures].[FOB US]),
                BDESC)))

      </Formula>
    </CalculatedMember>

  </Cube>

  <Cube name="imports">
    <Table name="pg_imports_grouped" schema="economy">
    </Table>
    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Origin Country" caption="Origin Country" source="Country" foreignKey="country_origin_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="importer_comuna_id" />
    <DimensionUsage name="Import HS" source="HS" foreignKey="hs_6digits" />

    <Measure name="CIF US" column="cif_us" aggregator="sum" />

    <CalculatedMember name="Geo Rank Across Time" dimension="Measures">
      <Annotations>
        <Annotation name="description">Rank of this geography across all its siblings, by time</Annotation>
      </Annotations>
      <Formula>
        Iif(IsEmpty([Measures].[CIF US]),
            Null,
            Rank([Geography].CurrentMember,
                 Order([Geography].CurrentMember.Siblings,
                       Aggregate({[Date].CurrentMember}*{[Origin Country].[All Origin Countrys]}*{[Import HS].[All Import HSs]},
                                 [Measures].[CIF US]),
                       BDESC)))

      </Formula>
    </CalculatedMember>
  </Cube>

  <Cube name="immigration">
    <Table name="fact_immigration_records" schema="public" />
    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="comuna_datachile_id" />
    <DimensionUsage name="Origin Country" caption="Origin Country" source="Country" foreignKey="country_code" />
    <DimensionUsage name="Sex" source="Sex" foreignKey="sex_id" />

    <Dimension name="Education" foreignKey="study_id">
      <Hierarchy hasAll="true">
        <InlineTable alias="education">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric"/>
            <ColumnDef name="description" type="String"/>
            <ColumnDef name="es_description" type="String"/>
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Unknown</Value>
              <Value column="es_description">No Informa</Value>
            </Row>
            <Row>
              <Value column="id">2</Value>
              <Value column="description">Higher Education</Value>
              <Value column="es_description">Educación Universitaria</Value>
            </Row>
            <Row>
              <Value column="id">4</Value>
              <Value column="description">High School</Value>
              <Value column="es_description">Educación Media</Value>
            </Row>
            <Row>
              <Value column="id">5</Value>
              <Value column="description">Primary School</Value>
              <Value column="es_description">Educación Básica</Value>
            </Row>
            <Row>
              <Value column="id">6</Value>
              <Value column="description">Technical Education</Value>
              <Value column="es_description">Educación Técnica</Value>
            </Row>
            <Row>
              <Value column="id">7</Value>
              <Value column="description">Some Primary School</Value>
              <Value column="es_description">Educación Pre-Básica</Value>
            </Row>
            <Row>
              <Value column="id">8</Value>
              <Value column="description">None</Value>
              <Value column="es_description">Ninguno</Value>
            </Row>
          </Rows>
        </InlineTable>
        <Level name="Education" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="Activity" foreignKey="activity_id">
      <Hierarchy hasAll="true">
        <InlineTable alias="activity">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric"/>
            <ColumnDef name="description" type="String"/>
            <ColumnDef name="es_description" type="String"/>
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Employee</Value>
              <Value column="es_description">Empleado</Value>
            </Row>
            <Row>
              <Value column="id">2</Value>
              <Value column="description">Student</Value>
              <Value column="es_description">Estudiante</Value>
            </Row>
            <Row>
              <Value column="id">3</Value>
              <Value column="description">Housewife</Value>
              <Value column="es_description">Dueña de Casa</Value>
            </Row>
            <Row>
              <Value column="id">4</Value>
              <Value column="description">Unemployed</Value>
              <Value column="es_description">Inactivo</Value>
            </Row>
            <Row>
              <Value column="id">5</Value>
              <Value column="description">Maid</Value>
              <Value column="es_description">Empleado Doméstico</Value>
            </Row>
            <Row>
              <Value column="id">6</Value>
              <Value column="description">No data</Value>
              <Value column="es_description">No Informa</Value>
            </Row>
            <Row>
              <Value column="id">7</Value>
              <Value column="description">Other activities</Value>
              <Value column="es_description">Otras Actividades</Value>
            </Row>
            <Row>
              <Value column="id">8</Value>
              <Value column="description">Religious</Value>
              <Value column="es_description">Religioso</Value>
            </Row>
            <Row>
              <Value column="id">9</Value>
              <Value column="description">Self-Employed</Value>
              <Value column="es_description">Trabajador por Cuenta Propia</Value>
            </Row>
            <Row>
              <Value column="id">10</Value>
              <Value column="description">No activity</Value>
              <Value column="es_description">Sin Actividad</Value>
            </Row>
            <Row>
              <Value column="id">11</Value>
              <Value column="description">Labourer</Value>
              <Value column="es_description">Obrero o Jornalero</Value>
            </Row>
            <Row>
              <Value column="id">12</Value>
              <Value column="description">Landlord</Value>
              <Value column="es_description">Rentista</Value>
            </Row>
            <Row>
              <Value column="id">13</Value>
              <Value column="description">Pilot</Value>
              <Value column="es_description">Tripulante</Value>
            </Row>
            <Row>
              <Value column="id">14</Value>
              <Value column="description">Businessperson</Value>
              <Value column="es_description">Empresario o Patrón</Value>
            </Row>
            <Row>
              <Value column="id">15</Value>
              <Value column="description">Retired</Value>
              <Value column="es_description">Jubilado o Pensionado</Value>
            </Row>
          </Rows>
        </InlineTable>
        <Level name="Activity" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="Visa Type" foreignKey="visa_type_id">
      <Hierarchy hasAll="true">
	<InlineTable alias="visa_type">
	  <ColumnDefs>
	    <ColumnDef name="id" type="Numeric" />
	    <ColumnDef name="description" type="String" />
	    <ColumnDef name="es_description" type="String" />
	  </ColumnDefs>
	  <Rows>
	    <Row>
	      <Value column="id">0</Value>
	      <Value column="description">nan</Value>
	      <Value column="es_description">nan</Value>
	    </Row>
	    <Row>
	      <Value column="id">1</Value>
	      <Value column="description">Student</Value>
	      <Value column="es_description">Estudiante</Value>
	    </Row>
	    <Row>
	      <Value column="id">2</Value>
	      <Value column="description">Temporary</Value>
	      <Value column="es_description">Temporaria</Value>
	    </Row>
	    <Row>
	      <Value column="id">3</Value>
	      <Value column="description">Subject to Contract</Value>
	      <Value column="es_description">Sujeta A Contrato</Value>
	    </Row>
	    <Row>
	      <Value column="id">4</Value>
	      <Value column="description">No benefit</Value>
	      <Value column="es_description">Sin Beneficio</Value>
	    </Row>
	    <Row>
	      <Value column="id">5</Value>
	      <Value column="description">Mercosur Temporary Stay Agreement</Value>
	      <Value column="es_description">Temp. Acuerdo Residencia Mercosur</Value>
	    </Row>
	  </Rows>
	</InlineTable>
        <Level name="Visa Type" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Measure name="Number of visas" column="birth_date" aggregator="count" />
    <Measure name="Average Age" column="age" aggregator="avg" />
  </Cube>


  <Cube name="tax_data">
    <Table name="tax_data" schema="economy" />
    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Tax Geography" source="Geography" foreignKey="comuna_id" />
    <DimensionUsage name="ISICrev4" source="ISICrev4" foreignKey="ciiu4_ori" />

    <Measure name="Output" column="output" aggregator="sum" />
    <Measure name="Labour" column="labour" aggregator="sum" />
    <Measure name="Labour Cost" column="labour_cost" aggregator="sum" />
    <Measure name="Investment" column="investment" aggregator="sum" />
    <Measure name="Intermediates" column="intermediates" aggregator="sum" />

    <CalculatedMember name="Value Added" dimension="Measures">
      <Formula>
        [Measures].[Output] - [Measures].[Intermediates]
      </Formula>
    </CalculatedMember>

    <CalculatedMember name="Labour Productivity Based on Sales" dimension="Measures">
      <Formula>
        Iif([Measures].[Labour] > 0, [Measures].[Output]/[Measures].[Labour], Null)
      </Formula>
    </CalculatedMember>

    <CalculatedMember name="Labour Productivity Based on Value Added" dimension="Measures">
      <Formula>
        Iif([Measures].[Labour] > 0, [Measures].[Value Added] / [Measures].[Labour], Null)
      </Formula>
    </CalculatedMember>
  </Cube>

  <Cube name="rd_survey">
    <Table name="fact_rd_survey" schema="public" />

    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Headquarters Country" caption="Headquarters Country" source="Country" foreignKey="headquarters_country_id" />
    <DimensionUsage name="ISICrev4" source="ISICrev4" level="Level 1" foreignKey="CIIU_level1" />

    <Dimension name="Business Type" foreignKey="org_juridica">
      <Hierarchy hasAll="true">
        <InlineTable alias="ownership_type">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric"/>
            <ColumnDef name="description" type="String"/>
            <ColumnDef name="es_description" type="String"/>
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Individual</Value>
              <Value column="es_description">Personal Natural</Value>
            </Row>
            <Row>
              <Value column="id">2</Value>
              <Value column="description">Limited Liability Company</Value>
              <Value column="es_description">Sociedad de Responsabilidad Limitada</Value>
            </Row>
            <Row>
              <Value column="id">3</Value>
              <Value column="description">General Partnership</Value>
              <Value column="es_description">Sociedad Colectiva</Value>
            </Row>
            <Row>
              <Value column="id">4</Value>
              <Value column="description">Closed Corporation</Value>
              <Value column="es_description">Sociedad Anónima Cerrada</Value>
            </Row>
            <Row>
              <Value column="id">5</Value>
              <Value column="description">Open Stock Coporation</Value>
              <Value column="es_description">Sociedad Anónima Abierta</Value>
            </Row>
            <Row>
              <Value column="id">6</Value>
              <Value column="description">Cooperative</Value>
              <Value column="es_description">Cooperativa</Value>
            </Row>
            <Row>
              <Value column="id">7</Value>
              <Value column="description">State-owned</Value>
              <Value column="es_description">Pública</Value>
            </Row>
            <Row>
              <Value column="id">8</Value>
              <Value column="description">Joint-stock company</Value>
              <Value column="es_description">Sociedad por Acciones</Value>
            </Row>
            <Row>
              <Value column="id">9</Value>
              <Value column="description">Single-owner limited liability company</Value>
              <Value column="es_description">EIRL</Value>
            </Row>
            <Row>
              <Value column="id">10</Value>
              <Value column="description">Other</Value>
              <Value column="es_description">Other</Value>
            </Row>
          </Rows>
        </InlineTable>
        <Level name="Business Type" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="Ownership Type" foreignKey="forma_propiedad">
      <Hierarchy hasAll="true">
        <InlineTable alias="ownership_type">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric"/>
            <ColumnDef name="description" type="String"/>
            <ColumnDef name="es_description" type="String"/>
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Private Domestic</Value>
              <Value column="es_description">Privada Nacional</Value>
            </Row>
            <Row>
              <Value column="id">2</Value>
              <Value column="description">Private Foreign</Value>
              <Value column="es_description">Privada Extranjera</Value>
            </Row>
            <Row>
              <Value column="id">3</Value>
              <Value column="description">Mixed</Value>
              <Value column="es_description">Mixta</Value>
            </Row>
            <Row>
              <Value column="id">4</Value>
              <Value column="description">State-owned</Value>
              <Value column="es_description">Estatal</Value>
            </Row>
          </Rows>
        </InlineTable>
        <Level name="Ownership Type" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Measure name="sales" column="ventas" visible="true" aggregator="sum" />
    <Measure name="exports" column="exportaciones" visible="true" aggregator="sum" />
    <Measure name="Total Spending" column="gasto_total" visible="true" aggregator="sum" />

    <!-- expenditure by region -->
    <Measure name="gasto_I_TARAPACA" column="gasto_I_TARAPACA" visible="true" aggregator="sum" />
    <Measure name="gasto_II_ANTOFAGASTA" column="gasto_II_ANTOFAGASTA" visible="true" aggregator="sum" />
    <Measure name="gasto_III_ATACAMA" column="gasto_III_ATACAMA" visible="true" aggregator="sum" />
    <Measure name="gasto_IV_COQUIMBO" column="gasto_IV_COQUIMBO" visible="true" aggregator="sum" />
    <Measure name="gasto_V_VALPARAISO" column="gasto_V_VALPARAISO" visible="true" aggregator="sum" />
    <Measure name="gasto_VI_OHIGGINS" column="gasto_VI_OHIGGINS" visible="true" aggregator="sum" />
    <Measure name="gasto_VII_MAULE" column="gasto_VII_MAULE" visible="true" aggregator="sum" />
    <Measure name="gasto_VIII_BIOBIO" column="gasto_VIII_BIOBIO" visible="true" aggregator="sum" />
    <Measure name="gasto_IX_ARAUCANIA" column="gasto_IX_ARAUCANIA" visible="true" aggregator="sum" />
    <Measure name="gasto_XIV_RIOS" column="gasto_XIV_RIOS" visible="true" aggregator="sum" />
    <Measure name="gasto_X_LAGOS" column="gasto_X_LAGOS" visible="true" aggregator="sum" />
    <Measure name="gasto_XI_AYSEN" column="gasto_XI_AYSEN" visible="true" aggregator="sum" />
    <Measure name="gasto_XII_MAGALLANES" column="gasto_XII_MAGALLANES" visible="true" aggregator="sum" />
    <Measure name="gasto_XIII_METROPOLITANA" column="gasto_XIII_METROPOLITANA" visible="true" aggregator="sum" />

    <!-- staff by region -->
    <Measure name="staff_I_TARAPACA" column="personal_73" visible="true" aggregator="sum" />
    <Measure name="staff_II_ANTOFAGASTA" column="personal_74" visible="true" aggregator="sum" />
    <Measure name="staff_III_ATACAMA" column="personal_75" visible="true" aggregator="sum" />
    <Measure name="staff_IV_COQUIMBO" column="personal_76" visible="true" aggregator="sum" />
    <Measure name="staff_V_VALPARAISO" column="personal_77" visible="true" aggregator="sum" />
    <Measure name="staff_VI_OHIGGINS" column="personal_78" visible="true" aggregator="sum" />
    <Measure name="staff_VII_MAULE" column="personal_79" visible="true" aggregator="sum" />
    <Measure name="staff_VIII_BIOBIO" column="personal_80" visible="true" aggregator="sum" />
    <Measure name="staff_IX_ARAUCANIA" column="personal_81" visible="true" aggregator="sum" />
    <Measure name="staff_XIV_RIOS" column="personal_82" visible="true" aggregator="sum" />
    <Measure name="staff_X_LAGOS" column="personal_82" visible="true" aggregator="sum" />
    <Measure name="staff_XI_AYSEN" column="personal_84" visible="true" aggregator="sum" />
    <Measure name="staff_XII_MAGALLANES" column="personal_85" visible="true" aggregator="sum" />
    <Measure name="staff_XIII_METROPOLITANA" column="personal_86" visible="true" aggregator="sum" />
  </Cube>

  <!--Cube name="income_gini">
    <Table name="fact_income_gini" schema="economy" />

    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="comuna_datachile_id" />

    <Measure name="region_mean_income" column="region_mean_income" visible="false" aggregator="min" />
    <Measure name="region_median_income" column="median_income" visible="false" aggregator="min" />
    <Measure name="region_gini_income" column="region_gini_income" visible="false" aggregator="min" />
    <Measure name="comuna_mean_income" column="comuna_mean_income" visible="false" aggregator="min" />
    <Measure name="comuna_median_income" column="comuna_median_income" visible="false" aggregator="min" />
    <Measure name="comuna_gini_income" column="comuna_gini_income" visible="false" aggregator="min" />

    <Measure name="region_ci_mean_income_lower" column="region_ci_mean_income_lower" visible="false" aggregator="min" />
    <Measure name="region_ci_mean_income_upper" column="region_ci_mean_income_upper" visible="false" aggregator="min" />
    <Measure name="region_ci_median_income_lower" column="region_ci_median_income_lower" visible="false" aggregator="min" />
    <Measure name="region_ci_median_income_upper" column="region_ci_median_income_upper" visible="false" aggregator="min" />
    <Measure name="region_ci_gini_income_lower" column="region_ci_gini_income_lower" visible="false" aggregator="min" />
    <Measure name="region_ci_gini_income_upper" column="region_ci_gini_income_upper" visible="false" aggregator="min" />
    <Measure name="comuna_ci_mean_income_lower" column="comuna_ci_mean_income_lower" visible="false" aggregator="min" />
    <Measure name="comuna_ci_mean_income_upper" column="comuna_ci_mean_income_upper" visible="false" aggregator="min" />
    <Measure name="comuna_ci_median_income_lower" column="comuna_ci_median_income_lower" visible="false" aggregator="min" />
    <Measure name="comuna_ci_median_income_upper" column="comuna_ci_median_income_upper" visible="false" aggregator="min" />
    <Measure name="comuna_ci_gini_income_lower" column="comuna_ci_gini_income_lower" visible="false" aggregator="min" />
    <Measure name="comuna_ci_gini_income_upper" column="comuna_ci_gini_income_upper" visible="false" aggregator="min" /-->

    <!-- This is a hackish way of implementing non-additive measures
         Taken from: http://forums.pentaho.com/showthread.php?65993-Support-for-non-additive-and-semi-additive-measures&p=202196#post202196 -->
    <!--CalculatedMember name="Mean Income" dimension="Measures">
      <Formula>
        CASE WHEN [Date].Level is [Date].Year
        THEN
          CASE
            WHEN [Geography].Level is [Geography].[Region] THEN [Measures].[region_mean_income]
            WHEN [Geography].Level is [Geography].[Comuna] THEN [Measures].[comuna_mean_income]
            ELSE Null
          END
        ELSE Null
        END
      </Formula>
    </CalculatedMember>

    <CalculatedMember name="Median Income" dimension="Measures">
      <Formula>
        CASE WHEN [Date].Level is [Date].Year
        THEN
          CASE
            WHEN [Geography].Level is [Geography].[Region] THEN [Measures].[region_median_income]
            WHEN [Geography].Level is [Geography].[Comuna] THEN [Measures].[comuna_median_income]
            ELSE Null
          END
        ELSE Null
        END
      </Formula>
    </CalculatedMember>

    <CalculatedMember name="Gini" dimension="Measures">
      <Formula>
        CASE WHEN [Date].Level is [Date].Year
        THEN
          CASE
            WHEN [Geography].Level is [Geography].[Region] THEN [Measures].[region_gini_income]
            WHEN [Geography].Level is [Geography].[Comuna] THEN [Measures].[comuna_gini_income]
            ELSE Null
          END
        ELSE Null
        END
      </Formula>
    </CalculatedMember>
  </Cube-->

  <!-- NESI -->
  <Cube name="nesi_income">
    <Table name="fact_income_nesi" schema="economy" />

    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="comuna_datachile_id" />
    <DimensionUsage name="Sex" source="Sex" foreignKey="sex_id" />
    <DimensionUsage name="Age Range" source="Age Range" foreignKey="age_range_id" />
    <DimensionUsage name="ISCO" source="ISCO" foreignKey="isco_id" />
    <DimensionUsage name="ICSE" source="ICSE" foreignKey="icse_id" />
    <DimensionUsage name="ISCED" source="ISCED" foreignKey="isced_id" />

    <Dimension name="Occupation Length" foreignKey="occupation_id">
      <Hierarchy hasAll="true">
    <InlineTable alias="occupation">
      <ColumnDefs>
	<ColumnDef name="id" type="Numeric" />
	<ColumnDef name="description" type="String" />
	<ColumnDef name="es_description" type="String" />
      </ColumnDefs>
      <Rows>
	<!-- Row>
	  <Value column="id">0</Value>
	  <Value column="description">nan</Value>
	  <Value column="es_description">nan</Value>
	</Row -->
	<Row>
	  <Value column="id">0</Value>
	  <Value column="description">Ocupados con menos de 1 mes en el empleo actual</Value>
	  <Value column="es_description">Ocupados con menos de 1 mes en el empleo actual</Value>
	</Row>
	<Row>
	  <Value column="id">1</Value>
	  <Value column="description">Ocupados con más de 1 mes en el empleo actual</Value>
	  <Value column="es_description">Ocupados con más de 1 mes en el empleo actual</Value>
	</Row>
      </Rows>
    </InlineTable>
            <Level name="Occupation Length" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="Workday" foreignKey="journey_id">
      <Hierarchy hasAll="true">
        <InlineTable alias="workdays">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric" />
            <ColumnDef name="description" type="String" />
            <ColumnDef name="es_description" type="String" />
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">0</Value>
              <Value column="description">N/A</Value>
              <Value column="es_description">N/A</Value>
            </Row>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Full-time</Value>
              <Value column="es_description">Completa</Value>
            </Row>
	    <Row>
              <Value column="id">2</Value>
              <Value column="description">Part-time</Value>
              <Value column="es_description">Parcial</Value>
            </Row>
          </Rows>
        </InlineTable>
        <Level name="Workday" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Measure name="Income" column="income" visible="true" aggregator="sum" />
    <Measure name="Expansion Factor" column="weight" visible="true" aggregator="sum" />
    <Measure name="Weighted Income" column="weighted_income" visible="true" aggregator="sum" />
  </Cube>
  <!-- / NESI -->

  <Cube name="internet_access">
    <Table name="fact_internet_access_survey" schema="environment" />
    <DimensionUsage name="Geography" source="Geography" level="Region" foreignKey="region_id" />
    <DimensionUsage name="Zone" source="Zone" level="Zone" foreignKey="zone_id" />

    <DimensionUsage name="Internet Plan" caption="Internet Plan" source="Binary Survey Response" foreignKey="internet_plan_id" />
    <DimensionUsage name="Home Access" caption="Home Access" source="Binary Survey Response" foreignKey="home_access_id" />
    <DimensionUsage name="Desktop Access" caption="Desktop Access" source="Binary Survey Response" foreignKey="desktop_access_id" />
    <DimensionUsage name="Laptop Access" caption="Laptop Access" source="Binary Survey Response" foreignKey="laptop_access_id" />
    <DimensionUsage name="Tablet Access" caption="Tablet Access" source="Binary Survey Response" foreignKey="tablet_access_id" />
    <DimensionUsage name="Cellphone Access" caption="Cellphone Access" source="Binary Survey Response" foreignKey="cellphone_access_id" />
    <DimensionUsage name="Games or Consoles Access" caption="Games or Consoles Access" source="Binary Survey Response" foreignKey="games_consoles_access_id" />
    <DimensionUsage name="TV Access" caption="TV Access" source="Binary Survey Response" foreignKey="tv_access_id" />

    <Measure name="Number of records" column="region_id" aggregator="count" visible="true" />
    <Measure name="Expansion factor" column="weights" aggregator="sum" visible="true" />
  </Cube>


  <!-- NENE -->
  <Cube name="nene">
    <Table name="fact_occupational_status_nene" schema="economy" />
    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <Dimension name="Geography" foreignKey="region_id">
      <Hierarchy hasAll="true" primaryKey="region_id">
      	<View alias="dim_regions">
      	  <SQL>(SELECT distinct(region_id), region_name from dim_comunas)</SQL>
      	</View>
      	<Level name="Region" column="region_id" nameColumn="region_name" uniqueMembers="true" />
      </Hierarchy>
    </Dimension>
    <DimensionUsage name="Sex" source="Sex" foreignKey="sex_id" />
    <DimensionUsage name="Age Range" source="Age Range" foreignKey="age_range_id" />
    <DimensionUsage name="ISCED" source="ISCED" foreignKey="isced_id" />
    <DimensionUsage name="ICSE" source="ICSE" foreignKey="icse_id" />
    <DimensionUsage name="ISCO" source="ISCO" foreignKey="isco_id" />

    <Dimension name="Occupational Situation" foreignKey="occupied_id">
      <Hierarchy hasAll="true">
        <InlineTable alias="occupational_situation">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric" />
            <ColumnDef name="description" type="String" />
            <ColumnDef name="es_description" type="String" />
          </ColumnDefs>
          <Rows>
	    <Row>
              <Value column="id">0</Value>
              <Value column="description">N/A</Value>
              <Value column="es_description">N/A</Value>
            </Row>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Ocupado</Value>
              <Value column="es_description">Ocupado</Value>
            </Row>
            <Row>
              <Value column="id">2</Value>
              <Value column="description">Desocupado</Value>
              <Value column="es_description">Desocupado</Value>
            </Row>
            <Row>
              <Value column="id">3</Value>
              <Value column="description">Inactivo</Value>
              <Value column="es_description">Inactivo</Value>
            </Row>
          </Rows>
        </InlineTable>
        <Level name="Occupational Situation" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="General Economic Condition" foreignKey="general_economic_condition">
      <Hierarchy hasAll="true">
        <InlineTable alias="general_economic_condition">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric" />
            <ColumnDef name="description" type="String" />
            <ColumnDef name="es_description" type="String" />
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">0</Value>
              <Value column="description">Menor de 15 años</Value>
              <Value column="es_description">Menor de 15 años</Value>
            </Row>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Ocupado tradicional</Value>
              <Value column="es_description">Ocupado tradicional</Value>
            </Row>
            <Row>
              <Value column="id">2</Value>
              <Value column="description">Ocupado notradicional</Value>
              <Value column="es_description">Ocupado notradicional</Value>
            </Row>
            <Row>
              <Value column="id">3</Value>
              <Value column="description">Ocupado ausente</Value>
              <Value column="es_description">Ocupado ausente</Value>
            </Row>
            <Row>
              <Value column="id">4</Value>
              <Value column="description">Cesante</Value>
              <Value column="es_description">Cesante</Value>
            </Row>
            <Row>
              <Value column="id">5</Value>
              <Value column="description">Busca trabajo por primera vez</Value>
              <Value column="es_description">Busca trabajo por primera vez</Value>
            </Row>
            <Row>
              <Value column="id">6</Value>
              <Value column="description">Iniciador</Value>
              <Value column="es_description">Iniciador</Value>
            </Row>
            <Row>
              <Value column="id">7</Value>
              <Value column="description">Inactivos que buscaron trabajo</Value>
              <Value column="es_description">Inactivos que buscaron trabajo</Value>
            </Row>
            <Row>
              <Value column="id">8</Value>
              <Value column="description">Inactivos que estuvieron disponibles para trabajar</Value>
              <Value column="es_description">Inactivos que estuvieron disponibles para trabajar</Value>
            </Row>
            <Row>
              <Value column="id">9</Value>
              <Value column="description">Inactivos que no buscaron trabajo ni estuvieron disponibles</Value>
              <Value column="es_description">Inactivos que no buscaron trabajo ni estuvieron disponibles</Value>
            </Row>
          </Rows>
        </InlineTable>
        <Level name="General Economic Condition" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Measure name="Internal Number of records" column="date_id" aggregator="count" visible="false" />
    <Measure name="Internal Expansion factor" column="weights" aggregator="sum" visible="false" />

    <CalculatedMember name="Number of records" dimension="Measures" visible="true">
      <Formula>
        IIF(Date.CurrentMember.Level.Name = 'Year',
            (
              [Measures].[Internal Number of records],
              LastNonEmpty(Descendants([Date].CurrentMember),
                           [Measures].[Internal Number of records])
            ),
            [Measures].[Internal Number of records])
      </Formula>
    </CalculatedMember>

    <CalculatedMember name="Expansion factor" dimension="Measures" visible="true">
      <Formula>
        IIF(Date.CurrentMember.Level.Name = 'Year',
            (
              [Measures].[Internal Expansion factor],
              LastNonEmpty(Descendants([Date].CurrentMember),
                          [Measures].[Internal Expansion Factor])
            ),
            [Measures].[Internal Expansion factor])
      </Formula>
    </CalculatedMember>
  </Cube>
  <!-- / NENE -->

  <!-- PSU -->

  <Cube name="psu">
    <Table name="fact_psu" schema="education" />
    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="comuna_datachile_id" />
    <DimensionUsage name="Sex" source="Sex" foreignKey="sex_id" />

    <Measure name="Number of records" column="year" aggregator="count" visible="true" />
    <Measure name="PSU AVG individual" visible="false" aggregator="sum">
      <MeasureExpression>
        <SQL>((language_test + math_test) / 2)</SQL>
      </MeasureExpression>
    </Measure>

    <CalculatedMember name="PSU Average" dimension="Measures" visible="true">
      <Formula>
        [Measures].[PSU AVG Individual] / [Measures].[Number of records]
      </Formula>
    </CalculatedMember>
  </Cube>

  <!-- / PSU -->

  <!-- Electoral data cube -->

  <Cube name="election_results">
    <Table name="fact_election_results" schema="politics" />
    
    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="comuna_datachile_id" />
    <DimensionUsage name="Sex" source="Sex" foreignKey="sex_id" />


    <Dimension name="Election Type" foreignKey="election_id">
      <Hierarchy hasAll="true">
        
        <InlineTable alias="election">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric" />
            <ColumnDef name="description" type="String" />
            <ColumnDef name="es_description" type="String" />
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Presidente - Primera vuelta</Value>
              <Value column="es_description">Presidente - Primera vuelta</Value>
            </Row>
          <Row>
              <Value column="id">2</Value>
              <Value column="description">Presidente - Segunda vuelta</Value>
              <Value column="es_description">Presidente - Segunda vuelta</Value>
            </Row>
          <Row>
              <Value column="id">3</Value>
              <Value column="description">Senador</Value>
              <Value column="es_description">Senador</Value>
            </Row>
          <Row>
              <Value column="id">4</Value>
              <Value column="description">Diputado</Value>
              <Value column="es_description">Diputado</Value>
            </Row>
          <Row>
              <Value column="id">5</Value>
              <Value column="description">Alcalde</Value>
              <Value column="es_description">Alcalde</Value>
            </Row>
          </Rows>
        </InlineTable>
        
        <Level name="Election Type" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="Party" foreignKey="party_id">
      <Hierarchy hasAll="true">
        <InlineTable alias="party">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric" />
            <ColumnDef name="description" type="String" />
            <ColumnDef name="es_description" type="String" />
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Partido Comunista de Chile (PCCh)</Value>
              <Value column="es_description">Partido Comunista de Chile (PCCh)</Value>
            </Row>
          <Row>
              <Value column="id">2</Value>
              <Value column="description">Partido Radical Socialdemocrata (PRSD)</Value>
              <Value column="es_description">Partido Radical Socialdemocrata (PRSD)</Value>
            </Row>
          <Row>
              <Value column="id">3</Value>
              <Value column="description">Partido Regionalista de los Independientes (PRI)</Value>
              <Value column="es_description">Partido Regionalista de los Independientes (PRI)</Value>
            </Row>
          <Row>
              <Value column="id">4</Value>
              <Value column="description">Partido Humanista (PH)</Value>
              <Value column="es_description">Partido Humanista (PH)</Value>
            </Row>
          <Row>
              <Value column="id">5</Value>
              <Value column="description">Partido Progresista (PRO)</Value>
              <Value column="es_description">Partido Progresista (PRO)</Value>
            </Row>
          <Row>
              <Value column="id">6</Value>
              <Value column="description">Unión Demócrata Independiente (UDI)</Value>
              <Value column="es_description">Unión Demócrata Independiente (UDI)</Value>
            </Row>
          <Row>
              <Value column="id">7</Value>
              <Value column="description">Renovación Nacional (RN)</Value>
              <Value column="es_description">Renovación Nacional (RN)</Value>
            </Row>
          <Row>
              <Value column="id">8</Value>
              <Value column="description">Independientes (IND)</Value>
              <Value column="es_description">Independientes (IND)</Value>
            </Row>
          <Row>
              <Value column="id">9</Value>
              <Value column="description">Partido Demócrata Cristiano (PDC)</Value>
              <Value column="es_description">Partido Demócrata Cristiano (PDC)</Value>
            </Row>
          <Row>
              <Value column="id">10</Value>
              <Value column="description">Partido Socialista de Chile (PS)</Value>
              <Value column="es_description">Partido Socialista de Chile (PS)</Value>
            </Row>
          <Row>
              <Value column="id">11</Value>
              <Value column="description">Partido por la Democracia (PPD)</Value>
              <Value column="es_description">Partido por la Democracia (PPD)</Value>
            </Row>
          <Row>
              <Value column="id">12</Value>
              <Value column="description">Partido Igualdad (PI)</Value>
              <Value column="es_description">Partido Igualdad (PI)</Value>
            </Row>
          <Row>
              <Value column="id">13</Value>
              <Value column="description">Partido Ecologista Verde (PEV)</Value>
              <Value column="es_description">Partido Ecologista Verde (PEV)</Value>
            </Row>
          <Row>
              <Value column="id">14</Value>
              <Value column="description">MAS Región (MAS Región)</Value>
              <Value column="es_description">MAS Región (MAS Región)</Value>
            </Row>
          <Row>
              <Value column="id">15</Value>
              <Value column="description">Partido Liberal de Chile (PL)</Value>
              <Value column="es_description">Partido Liberal de Chile (PL)</Value>
            </Row>
          <Row>
              <Value column="id">0</Value>
              <Value column="description">nan</Value>
              <Value column="es_description">nan</Value>
            </Row>
          </Rows>
        </InlineTable>
        
        <Level name="Party" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="Candidates" foreignKey="candidate_id">
      <Hierarchy hasAll="true" primaryKey="candidate_id">
        <Table name="dim_candidates" schema="politics" />
        <Level name="Candidate" column="candidate_id" nameColumn="candidate" uniqueMembers="true" />
      </Hierarchy>
    </Dimension>

    <Measure name="Number of records" column="year" aggregator="count" visible="true" />
    <Measure name="Votes" column="votes" aggregator="sum" visible="true" />

  </Cube>

  <!-- / Electoral data cube -->

  <!-- Education enrollment data cube -->

  <Cube name="education_enrollment">
    <Table name="fact_enrollment" schema="education" />
    
    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="comuna_datachile_id" />
    <DimensionUsage name="Sex" source="Sex" foreignKey="sex_id" />
    <DimensionUsage name="Zone" source="Zone" level="Zone" foreignKey="rural_id" />
    <DimensionUsage name="Administration" source="Administration" level="Administration" foreignKey="administration_id" />
    <DimensionUsage name="Institutions" source="Institution" level="Institution" foreignKey="institution_id" />
    <DimensionUsage name="Teachings" source="Teaching" level="Teaching" foreignKey="teaching_id" />

    <Measure name="Number of records" column="year" aggregator="count" visible="true" />
    <Measure name="Average Age" column="age" aggregator="avg" visible="true" />

  </Cube>

  <!-- / Education enrollment data cube -->



  <!-- Education performance data cube -->

  <Cube name="education_performance">
    <Table name="fact_performance" schema="education" />
    
    <DimensionUsage name="Date" source="Date" foreignKey="date_id" />
    <DimensionUsage name="Geography" source="Geography" foreignKey="comuna_datachile_id" />
    <DimensionUsage name="Sex" source="Sex" foreignKey="sex_id" />
    <DimensionUsage name="Zone" source="Zone" level="Zone" foreignKey="rural_id" />
    <DimensionUsage name="Administration" source="Administration" level="Administration" foreignKey="administration_id" />
    <DimensionUsage name="Institutions" source="Institution" level="Institution" foreignKey="institution_id" />
    <DimensionUsage name="Teachings" source="Teaching" level="Teaching" foreignKey="teaching_id" />

    <Measure name="Number of records" column="year" aggregator="count" visible="true" />
    <Measure name="Average Score Average (?)" column="scores_average" aggregator="avg" visible="true" />

  </Cube>

  <!-- / Education performance data cube -->

  <!-- Education employability data cube -->

  <Cube name="education_employability">
    <Table name="fact_employability" schema="education" />
    
    <Dimension name="Careers" foreignKey="career_id">
      <Hierarchy hasAll="true" primaryKey="career_id">
        <Table name="dim_careers" schema="education" />
        <Level name="Career" column="career_id" nameColumn="career" uniqueMembers="true" />
      </Hierarchy>
    </Dimension>

    <Dimension name="Institution" foreignKey="higher_educational_institution_id">
      <Hierarchy hasAll="true" primaryKey="higher_educational_institution_id">
        <Table name="dim_higher_educational_institutions" schema="education" />
        <Level name="Institution" column="higher_educational_institution_id" nameColumn="higher_educational_institution" uniqueMembers="true" />
      </Hierarchy>
    </Dimension>

    <Dimension name="Accreditation" foreignKey="accreditation_id">
      <Hierarchy hasAll="true">
        <InlineTable alias="accreditation">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric" />
            <ColumnDef name="description" type="String" />
            <ColumnDef name="es_description" type="String" />
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">2 años</Value>
              <Value column="es_description">2 años</Value>
            </Row>
          <Row>
              <Value column="id">2</Value>
              <Value column="description">3 años</Value>
              <Value column="es_description">3 años</Value>
            </Row>
          <Row>
              <Value column="id">3</Value>
              <Value column="description">4 años</Value>
              <Value column="es_description">4 años</Value>
            </Row>
          <Row>
              <Value column="id">4</Value>
              <Value column="description">5 años</Value>
              <Value column="es_description">5 años</Value>
            </Row>
          <Row>
              <Value column="id">5</Value>
              <Value column="description">6 años</Value>
              <Value column="es_description">6 años</Value>
            </Row>
          <Row>
              <Value column="id">6</Value>
              <Value column="description">7 años</Value>
              <Value column="es_description">7 años</Value>
            </Row>
          <Row>
              <Value column="id">7</Value>
              <Value column="description">No</Value>
              <Value column="es_description">No</Value>
            </Row>
          </Rows>
        </InlineTable>
        
        <Level name="Accreditation" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="Institution Type" foreignKey="higher_educational_institution_type_id">
      <Hierarchy hasAll="true">
        <InlineTable alias="higher_educational_institution_type">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric" />
            <ColumnDef name="description" type="String" />
            <ColumnDef name="es_description" type="String" />
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">Centro de FormaciĂłn TĂŠcnica</Value>
              <Value column="es_description">Centro de FormaciĂłn TĂŠcnica</Value>
            </Row>
          <Row>
              <Value column="id">2</Value>
              <Value column="description">Instituto Profesional</Value>
              <Value column="es_description">Instituto Profesional</Value>
            </Row>
          <Row>
              <Value column="id">3</Value>
              <Value column="description">Universidad</Value>
              <Value column="es_description">Universidad</Value>
            </Row>
          </Rows>
        </InlineTable>
        
        <Level name="Institution Type" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension name="Avg Income 4th year" foreignKey="avg_income_4th_id">
      <Hierarchy hasAll="true">
        <InlineTable alias="avg_income_4th_id">
          <ColumnDefs>
            <ColumnDef name="id" type="Numeric" />
            <ColumnDef name="description" type="String" />
            <ColumnDef name="es_description" type="String" />
          </ColumnDefs>
          <Rows>
            <Row>
              <Value column="id">1</Value>
              <Value column="description">De $1 millón 100 mil a $1 millón 200 mil</Value>
              <Value column="es_description">De $1 millón 100 mil a $1 millón 200 mil</Value>
            </Row>
          <Row>
              <Value column="id">2</Value>
              <Value column="description">De $1 millón 200 mil a $1 millón 300 mil</Value>
              <Value column="es_description">De $1 millón 200 mil a $1 millón 300 mil</Value>
            </Row>
          <Row>
              <Value column="id">3</Value>
              <Value column="description">De $1 millón 300 mil a $1 millón 400 mil</Value>
              <Value column="es_description">De $1 millón 300 mil a $1 millón 400 mil</Value>
            </Row>
          <Row>
              <Value column="id">4</Value>
              <Value column="description">De $1 millón 400 mil a $1 millón 500 mil</Value>
              <Value column="es_description">De $1 millón 400 mil a $1 millón 500 mil</Value>
            </Row>
          <Row>
              <Value column="id">5</Value>
              <Value column="description">De $1 millón 500 mil a $1 millón 600 mil</Value>
              <Value column="es_description">De $1 millón 500 mil a $1 millón 600 mil</Value>
            </Row>
          <Row>
              <Value column="id">6</Value>
              <Value column="description">De $1 millón 600 mil a $1 millón 700 mil</Value>
              <Value column="es_description">De $1 millón 600 mil a $1 millón 700 mil</Value>
            </Row>
          <Row>
              <Value column="id">7</Value>
              <Value column="description">De $1 millón 700 mil a $1 millón 800 mil</Value>
              <Value column="es_description">De $1 millón 700 mil a $1 millón 800 mil</Value>
            </Row>
          <Row>
              <Value column="id">8</Value>
              <Value column="description">De $1 millón 800 mil a $1 millón 900 mil</Value>
              <Value column="es_description">De $1 millón 800 mil a $1 millón 900 mil</Value>
            </Row>
          <Row>
              <Value column="id">9</Value>
              <Value column="description">De $1 millón 900 mil a $2 millones</Value>
              <Value column="es_description">De $1 millón 900 mil a $2 millones</Value>
            </Row>
          <Row>
              <Value column="id">10</Value>
              <Value column="description">De $1 millón a $1 millón 100 mil</Value>
              <Value column="es_description">De $1 millón a $1 millón 100 mil</Value>
            </Row>
          <Row>
              <Value column="id">11</Value>
              <Value column="description">De $2 millones 100 mil a $2 millones 200 mil</Value>
              <Value column="es_description">De $2 millones 100 mil a $2 millones 200 mil</Value>
            </Row>
          <Row>
              <Value column="id">12</Value>
              <Value column="description">De $2 millones 200 mil a $2 millones 300 mil</Value>
              <Value column="es_description">De $2 millones 200 mil a $2 millones 300 mil</Value>
            </Row>
          <Row>
              <Value column="id">13</Value>
              <Value column="description">De $2 millones 300 mil a $2 millones 400 mil</Value>
              <Value column="es_description">De $2 millones 300 mil a $2 millones 400 mil</Value>
            </Row>
          <Row>
              <Value column="id">14</Value>
              <Value column="description">De $2 millones 400 mil a $2 millones 500 mil</Value>
              <Value column="es_description">De $2 millones 400 mil a $2 millones 500 mil</Value>
            </Row>
          <Row>
              <Value column="id">15</Value>
              <Value column="description">De $2 millones a $2 millones 100 mil</Value>
              <Value column="es_description">De $2 millones a $2 millones 100 mil</Value>
            </Row>
          <Row>
              <Value column="id">16</Value>
              <Value column="description">De $300 mil a $400 mil</Value>
              <Value column="es_description">De $300 mil a $400 mil</Value>
            </Row>
          <Row>
              <Value column="id">17</Value>
              <Value column="description">De $400 mil a $500 mil</Value>
              <Value column="es_description">De $400 mil a $500 mil</Value>
            </Row>
          <Row>
              <Value column="id">18</Value>
              <Value column="description">De $500 mil a $600 mil</Value>
              <Value column="es_description">De $500 mil a $600 mil</Value>
            </Row>
          <Row>
              <Value column="id">19</Value>
              <Value column="description">De $600 mil a $700 mil</Value>
              <Value column="es_description">De $600 mil a $700 mil</Value>
            </Row>
          <Row>
              <Value column="id">20</Value>
              <Value column="description">De $700 mil a $800 mil</Value>
              <Value column="es_description">De $700 mil a $800 mil</Value>
            </Row>
          <Row>
              <Value column="id">21</Value>
              <Value column="description">De $800 mil a $900 mil</Value>
              <Value column="es_description">De $800 mil a $900 mil</Value>
            </Row>
          <Row>
              <Value column="id">22</Value>
              <Value column="description">De $900 mil a $1 millón</Value>
              <Value column="es_description">De $900 mil a $1 millón</Value>
            </Row>
          <Row>
              <Value column="id">23</Value>
              <Value column="description">Sobre $2 millones 500 mil</Value>
              <Value column="es_description">Sobre $2 millones 500 mil</Value>
            </Row>
          <Row>
              <Value column="id">24</Value>
              <Value column="description">nan</Value>
              <Value column="es_description">nan</Value>
            </Row>
          </Rows>
        </InlineTable>
        
        <Level name="Avg Income 4th year" column="id" nameColumn="description" uniqueMembers="true">
          <Annotations>
            <Annotation name="es_caption">Description ES</Annotation>
          </Annotations>
          <Property name="Description ES" column="es_description" />
        </Level>
      </Hierarchy>
    </Dimension>

    <Measure name="Number of records" column="higher_educational_institution_id" aggregator="count" visible="true" />
    
    <Measure name="Avg subsidized" column="pcent_subsidized" aggregator="avg" visible="true" />
    
    <Measure name="Avg Retention 1st year " column="1st_year_retention" aggregator="avg" visible="true" />
    
    <Measure name="Avg Duration in semesters" column="duration_in_semester" aggregator="avg" visible="true" />

    <Measure name="Avg employability 1st year" column="1st_year_employability" aggregator="avg" visible="true" />

    <Measure name="Avg anual payment 2016" column="annual_payment_2016" aggregator="avg" visible="true" />
    
    <Measure name="Sum anual payment 2016" column="annual_payment_2016" aggregator="sum" visible="true" />

  </Cube>

  <!-- / Education performance data cube -->

  <VirtualCube name="exports_and_imports">
    <VirtualCubeDimension name="Date" />
    <VirtualCubeDimension name="Geography" />

    <VirtualCubeMeasure cubeName="exports" name="[Measures].[FOB US]" visible="false" />
    <VirtualCubeMeasure cubeName="imports" name="[Measures].[CIF US]" visible="false" />

    <CalculatedMember name="FOB" dimension="Measures" visible="true">
      <Formula>ValidMeasure([Measures].[FOB US])</Formula>
    </CalculatedMember>

    <CalculatedMember name="CIF" dimension="Measures" visible="true">
      <Formula>ValidMeasure([Measures].[CIF US])</Formula>
    </CalculatedMember>

    <CalculatedMember name="Trade Balance" dimension="Measures" visible="true">
      <Formula>([Measures].[FOB US] - [Measures].[CIF US])</Formula>
    </CalculatedMember>
  </VirtualCube>
</Schema>
